# -*- python -*-
# ex: set syntax=python:
# {{ ansible_managed }}

from buildbot.plugins import *
import sys
sys.path.append('inplace')
from buildbot_inplace import InplaceConfig

import buildbot_inplace
reload(buildbot_inplace)

c = BuildmasterConfig = InplaceConfig()
c['protocols'] = {'pb': dict(port={{ buildbot_master_worker_port }})}

# loading workers makes it easier to extend
c.load_workers('{{ buildbot_master_workers_dir }}')

# loading projects
c.load_projects('{{ buildbot_master_projects_dir }}')

# TODO: add status targets
c['status'] = []

c['title'] = "{{ buildbot_master_title }}"
c['titleURL'] = "{{ buildbot_master_title_url }}"

c['buildbotURL'] = "{{ buildbot_master_url }}"
c['www'] = dict(port={{ buildbot_master_www_port }}, plugins=dict(waterfall_view={}, console_view={}))

c['db'] = {'db_url': "sqlite:///state.sqlite"}

c['products_dir'] = "{{ buildbot_master_products_dir }}""

# add change_source, schedulers and builders for all projects and workers
c.setup_inplace()
